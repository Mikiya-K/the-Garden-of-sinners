"use strict";function setRoute(a,b){a.when("/login",{cache:!1,templateUrl:"../views/login.html?version="+b.lastBuildTimeStamp,controller:"authenticationController"}).when("/dashboard",{templateUrl:"../views/dashboard.html?version="+b.lastBuildTimeStamp,controller:"dashboardController"}).when("/",{cache:!1,redirectTo:"/dashboard"}).when("/changePassword",{cache:!1,templateUrl:"./views/changePassword.html?version="+b.lastBuildTimeStamp,controller:"authenticationController"}).when("/user",{templateUrl:"../views/user.html?version="+b.lastBuildTimeStamp,controller:"userController"}).when("/marketing",{templateUrl:"../views/marketing.html?version="+b.lastBuildTimeStamp,controller:"marketingController"})}var app=angular.module("app",["ngRoute","ui.bootstrap","ipCookie"]);app.provider("versionTools",function(){this.lastBuildTimeStamp="20210903084630",this.$get=function(){var a=this.lastBuildTimeStamp;return{getLastBuildTimeStamp:function(){return a}}}}),app.config(["$routeProvider","$httpProvider","versionToolsProvider",function(a,b){setRoute(a,b)}]),app.run(["$rootScope","ipCookie","tools","$http","$location",function(a,b,c,d,e){a.loginUser=b(c.cookieName())||{},a.loginUser&&a.loginUser.authenticationToken&&(d.defaults.headers.common[c.tokenName()]=a.loginUser.authenticationToken),a.isLogin=!0,a.$on("$routeChangeSuccess",function(){a.isLogin=!0,-1===e.path().indexOf("/login")&&(a.isLogin=!1)})}]),app.factory("httpProxy",["$http","$q","apiTools","tools",function(a,b,c,d){var e=c.getApiUrl(),f=function(){},g=function(a,b){var c={};return c=null!=b&&"string"==typeof b&&""!=b?{code:a,errorMessage:b}:{code:a,errorMessage:"服务器内部错误，请联系管理员"},d.error(c),c};return{get:function(c,d){var h=b.defer(),i={method:"Get",headers:f(),url:e+c,cache:!1};return d=$.extend(i,d),a(d).success(function(a){h.resolve(a)}).error(function(a,b){var c=g(b,a);h.reject(c)}),h.promise},post:function(c,d,h){var i=b.defer(),j={method:"Post",headers:f(),crossDomain:!0,data:d,url:e+c,cache:!1};return h=$.extend(j,h),a(h).success(function(a){i.resolve(a)}).error(function(a,b){var c=g(b,a);i.reject(c)}),i.promise},put:function(c,d,h){var i=b.defer(),j={method:"Put",headers:f(),data:d,url:e+c,cache:!1};return h=$.extend(j,h),a(h).success(function(a){i.resolve(a)}).error(function(a,b){var c=g(b,a);i.reject(c)}),i.promise},delete:function(c,d){var h=b.defer(),i={method:"Delete",headers:f(),url:e+c,cache:!1};return d=$.extend(i,d),a(d).success(function(a){h.resolve(a)}).error(function(a,b){var c=g(b,a);h.reject(c)}),h.promise}}}]),app.factory("tools",["$rootScope","$location","$timeout",function(a,b,c){function d(b,d){var e={type:"danger",msg:b};a.alerts.push(e),d&&c(function(){a.$apply(function(){a.alerts.pop()})},5e3,!0)}function e(a){return void 0===a}return{success:function(b){var d={type:"success",msg:e(b)?"保存成功！":b};a.alerts.push(d),c(function(){a.$apply(function(){a.alerts.pop()})},2e3,!0)},error:function(a){if("escape key press"!==a&&void 0!=a)if("string"==typeof a)d(a,!0);else{if(401===a.code)return void b.path("/login");if(403===a.code)return void b.path("/login");if(404!==a.code)return void d(a.errorMessage,!0);b.path("/404")}},cookieName:function(){return"application_globals"},tokenName:function(){return"AuthenticationToken"}}}]),app.directive("datasPagination",function(){return{scope:{paginationinfo:"="},restrict:"EA",replace:!0,template:'<div><ul class="pagination pull-right" ng-show="paginationinfo.total>0"><li ng-if="paginationinfo.currentPage!=1"><a ng-click="prevPage()"">上一页</a></li><li ng-repeat="item in pageList track by $index" ng-class="{\'active\':item==paginationinfo.currentPage}"><a ng-click="changeCurrentPage(item)">{{item}}</a></li><li ng-if="paginationinfo.currentPage!=paginationinfo.numberOfPages"><a ng-click="nextPage()">下一页</a></li></ul><ul class="pagination pull-right pagination-lable" ng-show="paginationinfo.total>0"><li>每页条数<select ng-model="paginationinfo.pageSize" ng-options="option for option in paginationinfo.perPageOptions" ng-change="changepageSize()"></select> 共{{paginationinfo.total}}条记录，跳转至<input type="text" ng-model="jumpPageNum" ng-keyup="jumpPageKeyUp($event)" style="width:40px;" /></li></ul></div>',link:function(a){function b(b,d){if(c.currentPage&&(c.currentPage=parseInt(a.paginationinfo.currentPage,10)),c.currentPage||(c.currentPage=1),c.total&&(c.total=parseInt(c.total,10)),!c.total)return void(c.total=0);c.pageSize&&(c.pageSize=parseInt(c.pageSize,10)),c.pageSize||(c.pageSize=f),c.numberOfPages=Math.ceil(c.total/c.pageSize),a.paginationinfo.numberOfPages>0&&a.paginationinfo.currentPage>a.paginationinfo.numberOfPages&&(a.paginationinfo.currentPage=a.paginationinfo.numberOfPages);for(var e,g=a.paginationinfo.perPageOptions.length,h=0;h<g;h++)c.perPageOptions[h]==c.pageSize&&(e=!0);if(e||c.perPageOptions.push(c.pageSize),c.perPageOptions.sort(function(a,b){return a-b}),a.pageList=[],c.numberOfPages<=c.pagesLength)for(h=1;h<=c.numberOfPages;h++)a.pageList.push(h);else{var i=(c.pagesLength-1)/2;if(c.currentPage<=i){for(h=1;h<=i+1;h++)a.pageList.push(h);a.pageList.push("..."),a.pageList.push(c.numberOfPages)}else if(c.currentPage>c.numberOfPages-i){for(a.pageList.push(1),a.pageList.push("..."),h=i+1;h>=1;h--)a.pageList.push(c.numberOfPages-h);a.pageList.push(c.numberOfPages)}else{for(a.pageList.push(1),a.pageList.push("..."),h=Math.ceil(i/2);h>=1;h--)a.pageList.push(c.currentPage-h);for(a.pageList.push(c.currentPage),h=1;h<=i/2;h++)a.pageList.push(c.currentPage+h);a.pageList.push("..."),a.pageList.push(c.numberOfPages)}}a.$parent.paginationinfo=c}var c=a.paginationinfo,d=5,e=[10,20,30,40,50],f=15;c.pagesLength?(c.pagesLength=parseInt(c.pagesLength,10),c.pagesLength||(c.pagesLength=d),c.pagesLength%2==0&&(c.pagesLength+=1)):c.pagesLength=d,c.perPageOptions||(c.perPageOptions=e),a.prevPage=function(){c.currentPage>1&&(c.currentPage-=1),b(),c.onChange&&c.onChange()},a.nextPage=function(){c.currentPage<c.numberOfPages&&(c.currentPage+=1),b(),c.onChange&&c.onChange()},a.changeCurrentPage=function(a){"..."!=a&&(c.currentPage=a,b(),c.onChange&&c.onChange())},a.changepageSize=function(){c.currentPage=1,b(),c.onChange&&c.onChange()},a.jumpToPage=function(){var d=a.jumpPageNum;d.match(/\d+/)&&(d=parseInt(d,10))&&d!=c.currentPage&&(d>c.numberOfPages&&(d=c.numberOfPages),c.currentPage=d,b(),c.onChange&&c.onChange(),a.jumpPageNum="")},a.jumpPageKeyUp=function(b){13==(window.event?b.keyCode:b.which)&&a.jumpToPage()},a.$watch("paginationinfo.total",function(a,d){a&&a!=d||c.onChange&&c.onChange(),b()})}}}),$(document).ready(function(){$(document).on("click",'[data-toggle^="class"]',function(a){a&&a.preventDefault(),console.log("abc");var b,c,d,e,f,g=$(a.target);!g.data("toggle")&&(g=g.closest('[data-toggle^="class"]')),b=g.data().toggle,c=g.data("target")||g.attr("href"),b&&(d=b.split(":")[1])&&(e=d.split(",")),c&&(f=c.split(",")),e&&e.length&&$.each(f,function(a,b){if(-1!==e[a].indexOf("*")){var c=new RegExp("\\s"+e[a].replace(/\*/g,"[A-Za-z0-9-_]+").split(" ").join("\\s|\\s")+"\\s","g");$(g).each(function(a,b){for(var d=" "+b.className+" ";c.test(d);)d=d.replace(c," ");b.className=$.trim(d)})}"#"!=f[a]&&$(f[a]).toggleClass(e[a])||g.toggleClass(e[a])}),g.toggleClass("active")}),$(document).on("click","nav a",function(a){var b,c=$(a.target);c.is("a")||(c=c.closest("a")),b=c.parent().siblings(".active"),b&&b.toggleClass("active").find("> ul:visible").slideUp(200),c.parent().hasClass("active")&&c.next().slideUp(200)||c.next().slideDown(200),c.parent().toggleClass("active"),c.next().is("ul")&&a.preventDefault(),setTimeout(function(){$(document).trigger("updateNav")},300)})});