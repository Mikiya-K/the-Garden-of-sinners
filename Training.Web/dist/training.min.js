app.service("authenticationService",["httpProxy","ipCookie","$rootScope","tools","$http",function(a,b,c,d,e){var f={};return f.login=function(b){return a.post("login",b)},f.verification=function(b){return a.post("verification",b)},f.logout=function(b){return a.post("logout",b)},f.changepassword=function(b){return a.post("changepassword",b)},f.setCredentials=function(a){c.loginUser=a,c.loginUser.hasLogin=!0,e.defaults.headers.common[d.tokenName()]=a.authenticationToken,b(d.cookieName(),c.loginUser)},f.clearCredentials=function(){delete c.loginUser,b.remove(d.cookieName()),e.defaults.headers.common[d.tokenName()]=void 0},f}]),app.service("devcustomerService",["httpProxy",function(a){var b={};return b.getByPage=function(b){return a.get("devcustomer/pagination?"+jQuery.param(b))},b.add=function(b){return a.post("devcustomer",b)},b.edit=function(b,c){return a.put("devcustomer/"+b,c)},b.delete=function(b){return a.delete("devcustomer/"+b)},b}]),app.service("marketingService",["httpProxy",function(a){var b={};return b.getByPage=function(b){return a.get("marketing/pagination?"+jQuery.param(b))},b.add=function(b){return a.post("marketing",b)},b.edit=function(b,c){return a.put("marketing/"+b,c)},b.delete=function(b){return a.delete("marketing/"+b)},b}]),app.service("userService",["httpProxy",function(a){var b={};return b.getByPage=function(b){return a.get("users/pagination?"+jQuery.param(b))},b.add=function(b){return a.post("users",b)},b.edit=function(b,c){return a.put("users/"+b,c)},b.delete=function(b){return a.delete("users/"+b)},b}]),app.controller("alertController",["$scope","$rootScope",function(a,b){b.alerts=[],a.alerts=b.alerts,a.closeAlert=function(a){b.alerts.splice(a,1)}}]),app.controller("authenticationController",["$scope","$rootScope","$location","authenticationService","tools","ipCookie",function(a,b,c,d,e,f){function g(){if(!a.loginName||!a.password)return void e.error("请输入账号和密码");var b={loginName:a.loginName,password:a.password};a.isShowSpinner=!0,d.login(b).then(function(b){d.setCredentials(b),a.isShowSpinner=!1,c.path("/")},function(){a.isShowSpinner=!1})}function h(){var a={authenticationToken:f(e.cookieName()).authenticationToken};d.logout(a).then(function(){d.clearCredentials(),b.loginUser={},b.loginUser.isLogin=!1,c.path("/login")},function(){d.clearCredentials(),b.loginUser={},b.loginUser.isLogin=!1,c.path("/login")})}if(b.loginUser&&!b.loginUser.isLogin)if(void 0===f(e.cookieName()))c.path("/login");else{var i={authenticationToken:f(e.cookieName()).authenticationToken};d.verification(i).then(function(a){a?d.setCredentials(a):c.path("/login")},function(){c.path("/login")})}a.login=function(){g()},a.enter=function(a){13===a.keyCode&&g()},a.logout=function(){h()},a.changePassword=function(){var c={authenticationToken:b.loginUser.authenticationToken,oldPassword:a.oldPassword,newPassword:a.newPassword,confirmPassword:a.confirmPassword};a.isUsing=!0,d.changepassword(c).then(function(){e.success("修改成功，请重新登录"),h()},function(){a.isUsing=!1})},a.changeCancel=function(){a.oldPassword=null,a.newPassword=null,a.confirmPassword=null}}]),app.controller("dashboardController",["$scope","$http","$window","tools","$modal","$rootScope",function(a,b,c,d,e,f){}]),app.controller("devcustomerController",["$scope","devcustomerService","tools","$modal",function(a,b,c,d){function e(){a.isLoading=!0,b.getByPage({name:a.searchInfo.name,type:a.searchInfo.type,status:a.searchInfo.status,manager:a.searchInfo.manager,currentPage:a.pagination.currentPage,pageSize:a.pagination.pageSize}).then(function(b){a.isLoading=!1,a.devcustomers=b.list,a.pagination.currentPage=b.pagination.currentPage,a.pagination.pageSize=b.pagination.pageSize,a.pagination.total=b.pagination.total},function(){a.isLoading=!1})}function f(a,b,c,d,e){a.devcustomer=angular.copy(c),a.isUsing=!1,a.isAdd=e,a.ok=function(){a.isUsing=!0,e?d.add(a.devcustomer).then(function(){b.close()},function(){a.isUsing=!1}):d.edit(c.id,a.devcustomer).then(function(){b.close()},function(){a.isUsing=!1})}}function g(a,b,c,d){a.isUsing=!1,a.ok=function(){a.isUsing=!0,c.delete(d).then(function(){b.close()},function(){a.isUsing=!1})}}function h(){(a.pagination.currentPage-1)*a.pagination.pageSize==a.pagination.total-1&&(a.pagination.currentPage=a.pagination.currentPage-1)}a.searchInfo={},a.isLoading=!1,a.isUsing=!1,a.initialize=!0,a.devcustomers=[],a.selectedRow=null,a.setSelectedRow=function(b){a.selectedRow=b},a.pagination={currentPage:1,pageSize:10,onChange:function(){if(a.initialize)return void(a.initialize=!1);e()}},e(),a.search=function(){a.pagination.currentPage=1,e()},a.add=function(){a.isUsing=!0,a.devcustomer={},d.open({templateUrl:"addModal",controller:f,backdrop:"static",resolve:{devcustomer:function(){return a.devcustomer},isAdd:function(){return!0}}}).result.then(function(){a.isUsing=!1,c.success("保存成功"),e()},function(){a.isUsing=!1})},a.edit=function(b){a.isUsing=!0,a.devcustomer=b,d.open({templateUrl:"addModal",controller:f,backdrop:"static",resolve:{devcustomer:function(){return a.devcustomer},isAdd:function(){return!1}}}).result.then(function(){a.isUsing=!1,c.success("保存成功"),e()},function(){a.isUsing=!1})},a.delete=function(b){a.isUsing=!0,d.open({templateUrl:"deleteModal",controller:g,backdrop:"static",resolve:{id:function(){return b.id}}}).result.then(function(){a.isUsing=!1,c.success("删除成功"),h(),e()},function(){a.isUsing=!1})}}]),app.controller("marketingController",["$scope","marketingService","tools","$modal",function(a,b,c,d){function e(){a.isLoading=!0,b.getByPage({name:a.searchInfo.name,type:a.searchInfo.type,status:a.searchInfo.status,manager:a.searchInfo.manager,currentPage:a.pagination.currentPage,pageSize:a.pagination.pageSize}).then(function(b){a.isLoading=!1,a.marketing=b.list,a.pagination.currentPage=b.pagination.currentPage,a.pagination.pageSize=b.pagination.pageSize,a.pagination.total=b.pagination.total},function(){a.isLoading=!1})}function f(a,b,c,d,e){a.newmarketing=angular.copy(c),a.isUsing=!1,a.isAdd=e,a.ok=function(){a.isUsing=!0,e?d.add(a.newmarketing).then(function(){b.close()},function(){a.isUsing=!1}):d.edit(c.id,a.newmarketing).then(function(){b.close()},function(){a.isUsing=!1})}}function g(a,b,c,d){a.isUsing=!1,a.ok=function(){a.isUsing=!0,c.delete(d).then(function(){b.close()},function(){a.isUsing=!1})}}function h(){(a.pagination.currentPage-1)*a.pagination.pageSize==a.pagination.total-1&&(a.pagination.currentPage=a.pagination.currentPage-1)}a.searchInfo={},a.isLoading=!1,a.isUsing=!1,a.initialize=!0,a.marketing=[],a.selectedRow=null,a.setSelectedRow=function(b){a.selectedRow=b},a.pagination={currentPage:1,pageSize:10,onChange:function(){if(a.initialize)return void(a.initialize=!1);e()}},e(),a.search=function(){a.pagination.currentPage=1,e()},a.add=function(){a.isUsing=!0,a.newmarketing={},d.open({templateUrl:"addModal",controller:f,backdrop:"static",resolve:{newmarketing:function(){return a.newmarketing},isAdd:function(){return!0}}}).result.then(function(){a.isUsing=!1,c.success("保存成功"),e()},function(){a.isUsing=!1})},a.edit=function(b){a.isUsing=!0,a.newmarketing=b,d.open({templateUrl:"addModal",controller:f,backdrop:"static",resolve:{newmarketing:function(){return a.newmarketing},isAdd:function(){return!1}}}).result.then(function(){a.isUsing=!1,c.success("保存成功"),e()},function(){a.isUsing=!1})},a.delete=function(b){a.isUsing=!0,d.open({templateUrl:"deleteModal",controller:g,backdrop:"static",resolve:{id:function(){return b.id}}}).result.then(function(){a.isUsing=!1,c.success("删除成功"),h(),e()},function(){a.isUsing=!1})}}]),app.controller("userController",["$scope","userService","tools","$modal",function(a,b,c,d){function e(){a.isLoading=!0,b.getByPage({name:a.searchInfo.name,loginName:a.searchInfo.loginName,currentPage:a.pagination.currentPage,pageSize:a.pagination.pageSize}).then(function(b){a.isLoading=!1,a.users=b.list,a.pagination.currentPage=b.pagination.currentPage,a.pagination.pageSize=b.pagination.pageSize,a.pagination.total=b.pagination.total},function(){a.isLoading=!1})}function f(a,b,c,d,e){a.user=angular.copy(c),a.isUsing=!1,a.isAdd=e,a.ok=function(){a.isUsing=!0,e?d.add(a.user).then(function(){b.close()},function(){a.isUsing=!1}):d.edit(c.id,a.user).then(function(){b.close()},function(){a.isUsing=!1})}}function g(a,b,c,d){a.isUsing=!1,a.ok=function(){a.isUsing=!0,c.delete(d).then(function(){b.close()},function(){a.isUsing=!1})}}function h(){(a.pagination.currentPage-1)*a.pagination.pageSize==a.pagination.total-1&&(a.pagination.currentPage=a.pagination.currentPage-1)}a.searchInfo={},a.isLoading=!1,a.isUsing=!1,a.initialize=!0,a.users=[],a.selectedRow=null,a.setSelectedRow=function(b){a.selectedRow=b},a.pagination={currentPage:1,pageSize:10,onChange:function(){if(a.initialize)return void(a.initialize=!1);e()}},e(),a.search=function(){a.pagination.currentPage=1,e()},a.add=function(){a.isUsing=!0,a.user={},d.open({templateUrl:"addModal",controller:f,backdrop:"static",resolve:{user:function(){return a.user},isAdd:function(){return!0}}}).result.then(function(){a.isUsing=!1,c.success("保存成功"),e()},function(){a.isUsing=!1})},a.edit=function(b){a.isUsing=!0,a.user=b,d.open({templateUrl:"addModal",controller:f,backdrop:"static",resolve:{user:function(){return a.user},isAdd:function(){return!1}}}).result.then(function(){a.isUsing=!1,c.success("保存成功"),e()},function(){a.isUsing=!1})},a.delete=function(b){a.isUsing=!0,d.open({templateUrl:"deleteModal",controller:g,backdrop:"static",resolve:{id:function(){return b.id}}}).result.then(function(){a.isUsing=!1,c.success("删除成功"),h(),e()},function(){a.isUsing=!1})}}]);